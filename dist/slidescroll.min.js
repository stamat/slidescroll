/* slideswap v1.0.0 | https://stamat.github.io/slideswap/ | MIT License */
(()=>{function h(t,i){for(const s in i)t[s]=i[s];return t}var c=class{constructor(t,i){this.init(t,i)}init(t,i){if(this.element=t,this.currentIndex=0,this.visibility=[],this.options={start:0,loop:!0,behavior:"smooth",alignment:"start",activeClass:"slidescroll-current-slide",trackSelector:".slidescroll-track",slideSelector:":scope > *",next:null,prev:null},this.slides=[],this.track=null,this.isScrollingTo=!1,typeof t=="string"&&(this.element=document.querySelector(t)),!this.element||!(this.element instanceof HTMLElement))throw new Error("slidescroll: element property not provided, or element not found");if(this.element.getAttribute("data-slidescroll-initialized")==="true")throw new Error("slidescroll: element already initialized");h(this.options,i),this.track=this.element.querySelector(this.options.trackSelector),this.slides=Array.from(this.track.querySelectorAll(this.options.slideSelector)),this.element.setAttribute("data-slidescroll-initialized","true"),this.enumerateSlides(),this.bindControls(),this.options.start&&this.setInitialSlide(this.options.start),this.options.start||this.calculateSlideVisibility();let s=null,e=0,o=0,n="forward";this.element.addEventListener("scroll",()=>{let l=this.element.scrollTop,r=this.element.scrollLeft;l!==e?n=l>e?"forward":"backward":r!==o&&(n=r>o?"forward":"backward"),s&&clearTimeout(s),s=setTimeout(()=>{o!==r||e!==l||this.dispatchEvent("scrollstop",{direction:n})},100),e=l,o=r}),this.element.addEventListener("slidescroll:scrollstop",()=>{if(this.isScrollingTo){this.isScrollingTo=!1;return}this.calculateSlideVisibility();const l=this.getLastVisibleSlide(n);l!==void 0&&this.goTo(l)}),this.dispatchEvent("init")}calculateSlideVisibility(){const t=this.element.getBoundingClientRect();this.slides.forEach((i,s)=>{const e=i.getBoundingClientRect();if(e.bottom<t.top||e.top>t.bottom||e.right<t.left||e.left>t.right){this.visibility[s]=0;return}const o=Math.max(0,Math.min(e.bottom,t.bottom)-Math.max(e.top,t.top)),n=Math.max(0,Math.min(e.right,t.right)-Math.max(e.left,t.left)),l=e.bottom-e.top,r=e.right-e.left,a=o*n,d=l*r;this.visibility[s]=a/d*100})}getLastVisibleSlide(t){if(this.visibility.length){if(t==="backward")return this.visibility.findIndex(i=>i>0);for(let i=this.visibility.length-1;i>=0;i--)if(this.visibility[i]>0)return i}}setInitialSlide(){const t=this.slides[this.options.start];t&&t.scrollIntoView({behavior:"instant",block:this.options.alignment,inline:this.options.alignment})}bindControls(){!this.options.next&&!this.options.prev||(this.options.next=typeof this.options.next=="string"?document.querySelector(this.options.next):this.options.next,this.options.prev=typeof this.options.prev=="string"?document.querySelector(this.options.prev):this.options.prev,this.options.next&&this.options.next.addEventListener("click",this.next.bind(this)),this.options.prev&&this.options.prev.addEventListener("click",this.prev.bind(this)))}enumerateSlides(t=this.slides){t.forEach((i,s)=>{i.setAttribute("data-slidescroll-index",s)})}isScrollable(){return this.isVertical()||this.isHorizontal()}isVertical(){return this.track.scrollHeight>this.track.clientHeight}isHorizontal(){return this.track.scrollWidth>this.track.clientWidth}goTo(t){this.options.loop&&(t=t<0?this.slides.length-1:t,t=t>=this.slides.length?0:t);const i=this.slides[t];i&&(this.setActiveSlide(t),this.currentIndex=t,this.isScrollingTo=!0,i.scrollIntoView({behavior:this.options.behavior,block:this.options.alignment,inline:this.options.alignment}),this.dispatchEvent("change",{index:t}))}next(){const t=this.currentIndex+1;this.goTo(t)}prev(){const t=this.currentIndex-1;this.goTo(t)}setActiveSlide(t){this.slides.forEach((i,s)=>{i.classList.toggle(this.options.activeClass,s===t)})}dispatchEvent(t,i={}){if(!this.slides||!this.slides.length)return;const s=new CustomEvent(`slidescroll:${t}`,{detail:{...i,slidescroll:this}});this.element.dispatchEvent(s),document.dispatchEvent(s)}};window.Slidescroll||(window.Slidescroll=c)})();
