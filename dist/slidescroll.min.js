/* slideswap v1.0.0 | https://stamat.github.io/slideswap/ | MIT License */
(()=>{function h(t,i){for(const e in i)t[e]=i[e];return t}var c=class{constructor(t,i){this.init(t,i)}init(t,i){if(this.element=t,this.currentIndex=0,this.visibility=[],this.options={start:0,loop:!0,behavior:"smooth",alignment:"start",activeClass:"slidescroll-current-slide",trackSelector:".slidescroll-track",slideSelector:":scope > *",next:null,prev:null},this.slides=[],this.track=null,typeof t=="string"&&(this.element=document.querySelector(t)),!this.element||!(this.element instanceof HTMLElement))throw new Error("slidescroll: element property not provided, or element not found");if(this.element.getAttribute("data-slidescroll-initialized")==="true")throw new Error("slidescroll: element already initialized");h(this.options,i),this.track=this.element.querySelector(this.options.trackSelector),this.slides=Array.from(this.track.querySelectorAll(this.options.slideSelector)),this.element.setAttribute("data-slidescroll-initialized","true"),this.enumerateSlides(),this.bindControls(),this.options.start&&this.setInitialSlide(this.options.start),this.options.start||this.calculateSlideVisibility();let e=null,s=0,o=0,l="forward";this.element.addEventListener("scroll",()=>{let n=this.element.scrollTop,r=this.element.scrollLeft;n!==s?l=n>s?"forward":"backward":r!==o&&(l=r>o?"forward":"backward"),clearTimeout(e),e=setTimeout(()=>{this.calculateSlideVisibility(),console.log(this.visibility,this.getLastVisibleSlide()),this.goTo(this.getLastVisibleSlide().index),this.dispatchEvent("scrollstop",{direction:l})},150)}),this.dispatchEvent("init")}calculateSlideVisibility(){const t=this.element.getBoundingClientRect();this.slides.forEach((i,e)=>{const s=i.getBoundingClientRect();if(s.bottom<t.top||s.top>t.bottom||s.right<t.left||s.left>t.right){this.visibility[e]=0;return}const o=Math.max(0,Math.min(s.bottom,t.bottom)-Math.max(s.top,t.top)),l=Math.max(0,Math.min(s.right,t.right)-Math.max(s.left,t.left)),n=s.bottom-s.top,r=s.right-s.left,a=o*l,d=n*r;this.visibility[e]=a/d*100})}getLastVisibleSlide(){return this.visibility.reduce((t,i,e)=>i>t.visibility?{index:e,visibility:i}:t,{index:0,visibility:0})}setInitialSlide(){const t=this.slides[this.options.start];t&&t.scrollIntoView({behavior:"instant",block:this.options.alignment,inline:this.options.alignment})}bindControls(){!this.options.next&&!this.options.prev||(this.options.next=typeof this.options.next=="string"?document.querySelector(this.options.next):this.options.next,this.options.prev=typeof this.options.prev=="string"?document.querySelector(this.options.prev):this.options.prev,this.options.next&&this.options.next.addEventListener("click",this.next.bind(this)),this.options.prev&&this.options.prev.addEventListener("click",this.prev.bind(this)))}enumerateSlides(t=this.slides){t.forEach((i,e)=>{i.setAttribute("data-slidescroll-index",e)})}isScrollable(){return this.isVertical()||this.isHorizontal()}isVertical(){return this.track.scrollHeight>this.track.clientHeight}isHorizontal(){return this.track.scrollWidth>this.track.clientWidth}goTo(t){this.options.loop&&(t=t<0?this.slides.length-1:t,t=t>=this.slides.length?0:t);const i=this.slides[t];i&&(this.setActiveSlide(t),this.currentIndex=t,i.scrollIntoView({behavior:this.options.behavior,block:this.options.alignment,inline:this.options.alignment}),this.dispatchEvent("change",{index:t}))}next(){const t=this.currentIndex+1;this.goTo(t)}prev(){const t=this.currentIndex-1;this.goTo(t)}setActiveSlide(t){this.slides.forEach((i,e)=>{i.classList.toggle(this.options.activeClass,e===t)})}dispatchEvent(t,i={}){if(!this.slides||!this.slides.length)return;const e=new CustomEvent(`slidescroll:${t}`,{detail:{...i,slidescroll:this}});this.element.dispatchEvent(e),document.dispatchEvent(e)}};window.Slidescroll||(window.Slidescroll=c)})();
